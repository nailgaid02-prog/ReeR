# Минимальный Squid-конфиг для HTTP(S) прокси под API

# Порт, на котором Squid слушает запросы прокси
http_port 3128

# Разрешаем всех клиентов (любой IP)
acl all src 0.0.0.0/0
http_access allow all

# Разрешаем CONNECT только к HTTPS-порту 443
acl SSL_ports port 443
acl CONNECT method CONNECT
http_access allow CONNECT SSL_ports

# Минимальный cache_dir (нужен Squid, даже если кэш отключен)
cache_dir ufs /var/spool/squid 100 16 256

# Отключаем кэширование для API-запросов
cache deny all

# Логи (по умолчанию в файлы внутри контейнера)
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log

# Лимиты и таймауты под API
maximum_object_size_in_memory 512 KB
request_body_max_size 100 MB
reply_body_max_size 100 MB
max_filedescriptors 65536

connect_timeout 30 seconds
read_timeout 180 seconds
request_timeout 60 seconds
